## Half-sync/Half-async 设计模式

### Half-sync/Half-async 模式简介

> Half-sync/Half-async 模式集成了同步编程和异步编程的优势，它通过同步任务和异步任务的共同协作来完成一个计算，既保存了同步编程的简单性，又充分发挥异步编程在提高系统并发性方面的优势。
>
> Half-sync/Half-async 模式是一个分层架构，共三层：
> - 异步任务层
> - 同步任务层
> - 队列层

低级的任务(如与用户界面有关的任务)或者耗时短的任务可以安排在异步任务层。而高级的任务(如数据库访问)
或者耗时较长的任务可以安排在同步任务层。而异步任务层和同步任务层这两层之间的协作通过队列进行解耦(Decupling):
队列层负责异步任务层和同步任务层之间的数据交换。

### Half-sync/Half-async 模式的评价与实现考量

> Half-sync/Half-async 模式的异步层对接的是多线程环境，因此该层通常需要并发访问控制措施，如显示锁。而同步层是一个单线程环境，因此它无须任何并发访问控制即可保证线程安全。

#### 队列积压

> ArrayBlockingQueue 用于存储队列元素的存储空间是预先分配的，这意味着它在使用过程中内存开销较小(无须动态申请存储空间)
> 。无界队列可以使用 LinkedBlockingQueue，用于存储队列元素的存储空间是在其使用过程中动态分配的，因此它可能会增加 JVM
> 垃圾回收的负担。

#### 避免同步处理过慢

> 同步任务可能需要改为非阻塞 I/O(基于 Java NIO 的 API)，并采用专门的线程去处理 I/O 等待时间。

